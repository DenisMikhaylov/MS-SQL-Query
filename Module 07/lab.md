–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∑–∞–ø—Ä–æ—Å–æ–≤
```
–°—Ü–µ–Ω–∞—Ä–∏–π–í—ã —Ä–∞–±–æ—Ç–∞–µ—Ç–µ –±–∏–∑–Ω–µ—Å-–∞–Ω–∞–ª–∏—Ç–∏–∫–æ–º –≤ –∫–æ–º–ø–∞–Ω–∏–∏ Adventure Works –∏ —Å–æ–∑–¥–∞–µ—Ç–µ –æ—Ç—á—ë—Ç—ã, –∏—Å–ø–æ–ª—å–∑—É—è –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, —Ö—Ä–∞–Ω—è—â–∏–µ—Å—è –≤ SQL Server. –í–∞–º –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω—ã —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –±–∏–∑–Ω–µ—Å–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –∏ –≤–∞–º –ø—Ä–µ–¥—Å—Ç–æ–∏—Ç –Ω–∞–ø–∏—Å–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ T-SQL –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö. –ò–∑-–∑–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –≤–∞–º –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –≤–Ω–µ–¥—Ä—è—Ç—å –ø–æ–¥–∑–∞–ø—Ä–æ—Å—ã –≤ –≤–∞—à–∏ –∑–∞–ø—Ä–æ—Å—ã, —á—Ç–æ–±—ã –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–¥–Ω–∏–º –∑–∞–ø—Ä–æ—Å–æ–º.

–¶–µ–ª–∏–ü–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —ç—Ç–æ–π –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏ –≤—ã —Å–º–æ–∂–µ—Ç–µ:

–ü–∏—Å–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–µ –ø–æ–¥–∑–∞–ø—Ä–æ—Å—ã.
–ü–∏—Å–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–µ —Å–∫–∞–ª—è—Ä–Ω—ã–µ –∏ –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–µ –ø–æ–¥–∑–∞–ø—Ä–æ—Å—ã.
–ü–∏—Å–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–µ –∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–¥–∑–∞–ø—Ä–æ—Å—ã –∏ –ø—Ä–µ–¥–∏–∫–∞—Ç EXISTS.
–ü—Ä–∏–º–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è: 60 –º–∏–Ω—É—Ç

–í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞: 20761C-MIA-SQL

–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: AdventureWorks\Student

–ü–∞—Ä–æ–ª—å: Pa55w.rd
```
–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ 1: –ù–∞–ø–∏—Å–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏—Ö –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–µ –ø–æ–¥–∑–∞–ø—Ä–æ—Å—ã
```
–°—Ü–µ–Ω–∞—Ä–∏–π–û—Ç–¥–µ–ª –ø—Ä–æ–¥–∞–∂ –Ω—É–∂–¥–∞–µ—Ç—Å—è –≤ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö –æ—Ç—á–µ—Ç–∞—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∑–∞–∫–∞–∑–æ–≤. –í—ã –±—É–¥–µ—Ç–µ –ø–∏—Å–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã SELECT, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–µ –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–µ –ø–æ–¥–∑–∞–ø—Ä–æ—Å—ã.

–û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏ —ç—Ç–æ–≥–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –≤–∫–ª—é—á–∞—é—Ç —Å–ª–µ–¥—É—é—â–µ–µ:

–ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—É—é —Å—Ä–µ–¥—É.
–ù–∞–ø–∏—à–∏—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä SELECT –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –¥–∞—Ç—ã –∑–∞–∫–∞–∑–∞.
–ù–∞–ø–∏—à–∏—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä SELECT –¥–ª—è –≤—ã–±–æ—Ä–∫–∏ –≤—Å–µ—Ö –∑–∞–∫–∞–∑–æ–≤, —Ä–∞–∑–º–µ—â–µ–Ω–Ω—ã—Ö –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω—é—é –¥–∞—Ç—É –∑–∞–∫–∞–∑–∞.
–û–∑–Ω–∞–∫–æ–º—å—Ç–µ—Å—å —Å –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º T-SQL, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–º –ò–¢-–æ—Ç–¥–µ–ª–æ–º.
–ù–∞–ø–∏—à–∏—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä SELECT –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∫–∞–∂–¥–æ–π –ø—Ä–æ–¥–∞–∂–∏ –∫–∞–∫ –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –æ—Ç –æ–±—â–µ–π —Å—É–º–º—ã –ø—Ä–æ–¥–∞–∂.
```
```
‚úîÔ∏è –ó–∞–¥–∞—á–∞ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Å—Ä–µ–¥—ã

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã 20761C-MIA-DC –∏ 20761C-MIA-SQL –∑–∞–ø—É—â–µ–Ω—ã, –∑–∞—Ç–µ–º –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É –Ω–∞ –º–∞—à–∏–Ω–µ 20761C-MIA-SQL –∫–∞–∫ ADVENTUREWORKS\Student —Å –ø–∞—Ä–æ–ª–µ–º Pa55w.rd.
–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ñ–∞–π–ª Setup.cmd –≤ –ø–∞–ø–∫–µ D:\Labfiles\Lab10\Starter –æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.

‚úîÔ∏è –ó–∞–¥–∞—á–∞ 2: –ù–∞–ø–∏—Å–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ SELECT –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –¥–∞—Ç—ã –∑–∞–∫–∞–∑–∞

–û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–æ–µ–∫—Ç-—Ñ–∞–π–ª D:\Labfiles\Lab10\Starter\Project\Project.ssmssln –∏ —Å–∫—Ä–∏–ø—Ç T-SQL 51-Lab Exercise 1.sql. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö TSQL.
–ù–∞–ø–∏—à–∏—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä SELECT –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –¥–∞—Ç—ã –∑–∞–∫–∞–∑–∞ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã Sales.Orders.
–í—ã–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–π –≤–∞–º–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å —Ç—Ä–µ–±—É–µ–º—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏, –ø–æ–∫–∞–∑–∞–Ω–Ω—ã–º–∏ –≤ —Ñ–∞–π–ª–µ D:\Labfiles\Lab10\Solution\52 - Lab Exercise 1 - Task 1 Result.txt

‚úîÔ∏è –ó–∞–¥–∞—á–∞ 3: –ù–∞–ø–∏—Å–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ SELECT –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ—Ö –∑–∞–∫–∞–∑–æ–≤, —Å–¥–µ–ª–∞–Ω–Ω—ã—Ö –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω—é—é –¥–∞—Ç—É –∑–∞–∫–∞–∑–∞

–ù–∞–ø–∏—à–∏—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä SELECT –¥–ª—è –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ orderid, orderdate, empid –∏ custid –∏–∑ —Ç–∞–±–ª–∏—Ü—ã Sales.Orders. –û—Ç—Ñ–∏–ª—å—Ç—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ–±—ã –≤–∫–ª—é—á–∏—Ç—å —Ç–æ–ª—å–∫–æ –∑–∞–∫–∞–∑—ã, –¥–∞—Ç–∞ –∫–æ—Ç–æ—Ä—ã—Ö —Ä–∞–≤–Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π –¥–∞—Ç–µ –∑–∞–∫–∞–∑–∞. (–ü–æ–¥—Å–∫–∞–∑–∫–∞: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∑–∞–ø—Ä–æ—Å –∏–∑ –∑–∞–¥–∞–Ω–∏—è 1 –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–≥–æ –ø–æ–¥–∑–∞–ø—Ä–æ—Å–∞.)
–í—ã–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–π –≤–∞–º–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å —Ç—Ä–µ–±—É–µ–º—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏, —É–∫–∞–∑–∞–Ω–Ω—ã–º–∏ –≤ —Ñ–∞–π–ª–µ D:\Labfiles\Lab10\Solution\53 - Lab Exercise 1 - Task 2 Result.txt.

‚úîÔ∏è –ó–∞–¥–∞—á–∞ 4: –ü—Ä–æ—Å–º–æ—Ç—Ä –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ T-SQL, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–≥–æ –æ—Ç–¥–µ–ª–æ–º –ò–¢

–û—Ç–¥–µ–ª –ò–¢ –Ω–∞–ø–∏—Å–∞–ª –æ–ø–µ—Ä–∞—Ç–æ—Ä T-SQL, –∏–∑–≤–ª–µ–∫–∞—é—â–∏–π –∑–∞–∫–∞–∑—ã –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤, —á—å—ë –∫–æ–Ω—Ç–∞–∫—Ç–Ω–æ–µ –ª–∏—Ü–æ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –±—É–∫–≤—ã 'I':

SELECT
   orderid, orderdate, empid, custid
FROM Sales.Orders
WHERE
   custid = (
      SELECT custid
      FROM Sales.Customers
      WHERE contactname LIKE N'I%'
   );
–í—ã–ø–æ–ª–Ω–∏—Ç–µ —ç—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å –∏ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç.
–ò–∑–º–µ–Ω–∏—Ç–µ –∑–∞–ø—Ä–æ—Å —Ç–∞–∫, —á—Ç–æ–±—ã —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤, —á—å—ë –∫–æ–Ω—Ç–∞–∫—Ç–Ω–æ–µ –ª–∏—Ü–æ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –±—É–∫–≤—ã 'B'.
–í—ã–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–ø—Ä–æ—Å. –ß—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ? –ö–∞–∫–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –ø–æ—è–≤–∏–ª–æ—Å—å? –ü–æ—á–µ–º—É –∑–∞–ø—Ä–æ—Å –∑–∞–≤–µ—Ä—à–∏–ª—Å—è –Ω–µ—É–¥–∞—á–µ–π?
–ü—Ä–∏–º–µ–Ω–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫ –æ–ø–µ—Ä–∞—Ç–æ—Ä—É T-SQL, —á—Ç–æ–±—ã –æ–Ω –≤—ã–ø–æ–ª–Ω—è–ª—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫.
–í—ã–ø–æ–ª–Ω–∏—Ç–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å —Ç—Ä–µ–±—É–µ–º—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏, —É–∫–∞–∑–∞–Ω–Ω—ã–º–∏ –≤ —Ñ–∞–π–ª–µ D:\Labfiles\Lab10\Solution\54 - Lab Exercise 1 - Task 3 Result.txt.

‚úîÔ∏è –ó–∞–¥–∞—á–∞ 5: –ù–∞–ø–∏—Å–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ SELECT –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∫–∞–∂–¥–æ–≥–æ –∑–∞–∫–∞–∑–∞ –∫–∞–∫ –ø—Ä–æ—Ü–µ–Ω—Ç–Ω–æ–π –¥–æ–ª–∏ –æ—Ç –æ–±—â–µ–π —Å—É–º–º—ã –ø—Ä–æ–¥–∞–∂

–ù–∞–ø–∏—à–∏—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä SELECT –¥–ª—è –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞ orderid –∏–∑ —Ç–∞–±–ª–∏—Ü—ã Sales.Orders –∏ —Å–ª–µ–¥—É—é—â–∏—Ö –≤—ã—á–∏—Å–ª—è–µ–º—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤:
totalsalesamount (–æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ –∑–Ω–∞—á–µ–Ω–∏—è—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ qty –∏ unitprice –≤ —Ç–∞–±–ª–∏—Ü–µ Sales.OrderDetails).
salespctoftotal (–ø—Ä–æ—Ü–µ–Ω—Ç –æ–±—â–µ–π —Å—É–º–º—ã –ø—Ä–æ–¥–∞–∂ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–∫–∞–∑–∞, –ø–æ–¥–µ–ª—ë–Ω–Ω—ã–π –Ω–∞ –æ–±—â—É—é —Å—É–º–º—É –ø—Ä–æ–¥–∞–∂ –∑–∞ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥).
–§–∏–ª—å—Ç—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –≤–∫–ª—é—á–∞—è —Ç–æ–ª—å–∫–æ –∑–∞–∫–∞–∑—ã, —Å–¥–µ–ª–∞–Ω–Ω—ã–µ –≤ –º–∞–µ 2008 –≥–æ–¥–∞.
–í—ã–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–π –≤–∞–º–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å —Ç—Ä–µ–±—É–µ–º—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏, —É–∫–∞–∑–∞–Ω–Ω—ã–º–∏ –≤ —Ñ–∞–π–ª–µ D:\Labfiles\Lab10\Solution\55 - Lab Exercise 1 - Task 4 Result.txt.
```
–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ 2: –ù–∞–ø–∏—Å–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏—Ö —Å–∫–∞–ª—è—Ä–Ω—ã–µ –∏ –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–µ –ø–æ–¥–∑–∞–ø—Ä–æ—Å—ã
```
–°—Ü–µ–Ω–∞—Ä–∏–π–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã–π –æ—Ç–¥–µ–ª —Ö–æ—á–µ—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –≥—Ä—É–ø–ø –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∏ –∫–ª–∏–µ–Ω—Ç–æ–≤, –æ—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –æ –ø—Ä–æ–¥–∞–∂–∞—Ö. –í–∞–º –ø—Ä–µ–¥—Å—Ç–æ–∏—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã SELECT, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–µ –ø–æ–¥–∑–∞–ø—Ä–æ—Å –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏ WHERE.

–û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏ —ç—Ç–æ–≥–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –≤–∫–ª—é—á–∞—é—Ç —Å–ª–µ–¥—É—é—â–µ–µ:

–ù–∞–ø–∏—Å–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ SELECT –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤.
–ù–∞–ø–∏—Å–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ SELECT –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤, —É –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –∑–∞–∫–∞–∑–æ–≤.
–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞, –≤—ã–±–∏—Ä–∞—é—â–µ–≥–æ –∫–ª–∏–µ–Ω—Ç–æ–≤ –±–µ–∑ –∑–∞–∫–∞–∑–æ–≤.
```
```
‚úîÔ∏è –ó–∞–¥–∞—á–∞ 1: –ù–∞–ø–∏—Å–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ SELECT –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤

–û—Ç–∫—Ä–æ–π—Ç–µ —Å–∫—Ä–∏–ø—Ç T-SQL 61-Lab Exercise 2.sql. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö TSQL.
–ù–∞–ø–∏—à–∏—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä SELECT –¥–ª—è –≤—ã–±–æ—Ä–∞ —Å—Ç–æ–ª–±—Ü–æ–≤ productid –∏ productname –∏–∑ —Ç–∞–±–ª–∏—Ü—ã Production.Products. –û—Ç—Ñ–∏–ª—å—Ç—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –≤–∫–ª—é—á–∏–≤ —Ç–æ–ª—å–∫–æ —Ç–æ–≤–∞—Ä—ã, –ø—Ä–æ–¥–∞–Ω–Ω—ã–µ –±–æ–ª—å—à–∏–º–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞–º–∏ (–±–æ–ª–µ–µ 100 —à—Ç—É–∫) –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –∑–∞–∫–∞–∑–∞.
–í—ã–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–π –≤–∞–º–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–º–∏ –≤ —Ñ–∞–π–ª–µ D:\Labfiles\Lab10\Solution\62 - Lab Exercise 2 - Task 1 Result.txt.

‚úîÔ∏è –ó–∞–¥–∞—á–∞ 2: –ù–∞–ø–∏—Å–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ SELECT –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –±–µ–∑ –∑–∞–∫–∞–∑–æ–≤

–ù–∞–ø–∏—à–∏—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä SELECT –¥–ª—è –≤—ã–±–æ—Ä–∞ —Å—Ç–æ–ª–±—Ü–æ–≤ custid –∏ contactname –∏–∑ —Ç–∞–±–ª–∏—Ü—ã Sales.Customers. –û—Ç—Ñ–∏–ª—å—Ç—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –≤–∫–ª—é—á–∏–≤ —Ç–æ–ª—å–∫–æ —Ç–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤, —É –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –Ω–∏ –æ–¥–Ω–æ–≥–æ —Ä–∞–∑–º–µ—â—ë–Ω–Ω–æ–≥–æ –∑–∞–∫–∞–∑–∞.
–í—ã–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–π –≤–∞–º–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–º–∏ –≤ —Ñ–∞–π–ª–µ D:\Labfiles\Lab10\Solution\63 - Lab Exercise 2 - Task 2 Result.txt. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö.

‚úîÔ∏è –ó–∞–¥–∞—á–∞ 3: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞, –≤—ã–±–∏—Ä–∞—é—â–µ–≥–æ –∫–ª–∏–µ–Ω—Ç–æ–≤ –±–µ–∑ –∑–∞–∫–∞–∑–æ–≤

–û—Ç–¥–µ–ª –ò–¢ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏–ª –æ–ø–µ—Ä–∞—Ç–æ—Ä T-SQL, –≤—Å—Ç–∞–≤–ª—è—é—â–∏–π –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é —Å—Ç—Ä–æ–∫—É –≤ —Ç–∞–±–ª–∏—Ü—É Sales.Orders. –≠—Ç–∞ —Å—Ç—Ä–æ–∫–∞ –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ NULL –≤ —Å—Ç–æ–ª–±—Ü–µ custid:
```
```
INSERT INTO Sales.Orders (
   custid, empid, orderdate, requireddate, shippeddate, shipperid, freight,
   shipname, shipaddress, shipcity, shipregion, shippostalcode, shipcountry)
VALUES
(NULL, 1, '20111231', '20111231', '20111231', 1, 0,
'ShipOne', 'ShipAddress', 'ShipCity', 'RA', '1000', 'USA');
```
```
–í—ã–ø–æ–ª–Ω–∏—Ç–µ —ç—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å —Ç–æ—á–Ω–æ —Ç–∞–∫ –∂–µ, –∫–∞–∫ –Ω–∞–ø–∏—Å–∞–Ω–æ, –≤–Ω—É—Ç—Ä–∏ –æ–∫–Ω–∞ –∑–∞–ø—Ä–æ—Å–∞.
–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä T-SQL, –∫–æ—Ç–æ—Ä—ã–π –≤—ã –Ω–∞–ø–∏—Å–∞–ª–∏ –≤ –∑–∞–¥–∞—á–µ 2, –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –µ–≥–æ —Å–Ω–æ–≤–∞.
–ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –°–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ? –ü–æ—á–µ–º—É?
–ò–∑–º–µ–Ω–∏—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä T-SQL —Ç–∞–∫, —á—Ç–æ–±—ã –≤–µ—Ä–Ω—É—Ç—å —Ç–∞–∫–æ–µ –∂–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫, –∫–∞–∫ –≤ –∑–∞–¥–∞—á–µ 2. (–ü–æ–¥—Å–∫–∞–∑–∫–∞: –≤–∞–º –ø—Ä–∏–¥—ë—Ç—Å—è –∏—Å–∫–ª—é—á–∏—Ç—å —Å—Ç—Ä–æ–∫–∏ —Å –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º –≤ —Å—Ç–æ–ª–±—Ü–µ custid.)
–í—ã–ø–æ–ª–Ω–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–º–∏ –≤ —Ñ–∞–π–ª–µ D:\Labfiles\Lab10\Solution\64 - Lab Exercise 2 - Task 3 Result.txt.
```
–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ 3: –ù–∞–ø–∏—Å–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏—Ö –∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–¥–∑–∞–ø—Ä–æ—Å—ã –∏ –ø—Ä–µ–¥–∏–∫–∞—Ç EXISTS
```
–°—Ü–µ–Ω–∞—Ä–∏–π–û—Ç–¥–µ–ª –ø—Ä–æ–¥–∞–∂ —Ö–æ—Ç–µ–ª –±—ã –∏–º–µ—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∞–Ω–∞–ª–∏–∑–æ–≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤. –ü–æ—Å–∫–æ–ª—å–∫—É –∑–∞–ø—Ä–æ—Å—ã —è–≤–ª—è—é—Ç—Å—è —Å–ª–æ–∂–Ω—ã–º–∏, –≤–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–¥–∑–∞–ø—Ä–æ—Å—ã.

–û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏ —ç—Ç–æ–≥–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –≤–∫–ª—é—á–∞—é—Ç —Å–ª–µ–¥—É—é—â–µ–µ:

–ù–∞–ø–∏—Å–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ SELECT –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –¥–∞—Ç—ã –∑–∞–∫–∞–∑–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞.
–ù–∞–ø–∏—Å–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ SELECT, –∏—Å–ø–æ–ª—å–∑—É—é—â–µ–≥–æ –ø—Ä–µ–¥–∏–∫–∞—Ç EXISTS –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –±–µ–∑ –∑–∞–∫–∞–∑–æ–≤.
–ù–∞–ø–∏—Å–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ SELECT –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤, –∫—É–ø–∏–≤—à–∏—Ö –¥–æ—Ä–æ–≥–∏–µ –ø—Ä–æ–¥—É–∫—Ç—ã.
–ù–∞–ø–∏—Å–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ SELECT –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ–±—â–µ–π —Å—É–º–º—ã –ø—Ä–æ–¥–∞–∂ –∏ –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–æ–π —Å—É–º–º—ã –ø—Ä–æ–¥–∞–∂ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≥–æ–¥–∞ –∑–∞–∫–∞–∑–æ–≤.
–û—á–∏—Å—Ç–∫–∞ —Ç–∞–±–ª–∏—Ü—ã Sales.Customers.

‚úîÔ∏è –ó–∞–¥–∞—á–∞ 1: –ù–∞–ø–∏—Å–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ SELECT –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –¥–∞—Ç—ã –∑–∞–∫–∞–∑–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞

–û—Ç–∫—Ä–æ–π—Ç–µ —Å–∫—Ä–∏–ø—Ç T-SQL 71-Lab Exercise 3.sql. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö TSQL.
–ù–∞–ø–∏—à–∏—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä SELECT –¥–ª—è –≤—ã–±–æ—Ä–∫–∏ —Å—Ç–æ–ª–±—Ü–æ–≤ custid –∏ contactname –∏–∑ —Ç–∞–±–ª–∏—Ü—ã Sales.Customers. –î–æ–±–∞–≤—å—Ç–µ –≤—ã—á–∏—Å–ª—è–µ–º—ã–π —Å—Ç–æ–ª–±–µ—Ü —Å –∏–º–µ–Ω–µ–º lastorderdate, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –ø–æ—Å–ª–µ–¥–Ω—é—é –¥–∞—Ç—É –∑–∞–∫–∞–∑–∞ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã Sales.Orders –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞. (–ü–æ–¥—Å–∫–∞–∑–∫–∞: –≤–∞–º –ø—Ä–∏–¥–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥–∑–∞–ø—Ä–æ—Å.)
–í—ã–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–π –≤–∞–º–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–º–∏ –≤ —Ñ–∞–π–ª–µ D:\Labfiles\Lab10\Solution\72 - Lab Exercise 3 - Task 1 Result.txt.

‚úîÔ∏è –ó–∞–¥–∞—á–∞ 2: –ù–∞–ø–∏—Å–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ SELECT, –∏—Å–ø–æ–ª—å–∑—É—é—â–µ–≥–æ –ø—Ä–µ–¥–∏–∫–∞—Ç EXISTS –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –±–µ–∑ –∑–∞–∫–∞–∑–æ–≤

–ù–∞–ø–∏—à–∏—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä SELECT –¥–ª—è –≤—ã–±–æ—Ä–∫–∏ –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤, —É –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –∑–∞–∫–∞–∑–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü–µ Sales.Orders, –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –∑–∞–ø—Ä–æ—Å—É –∏–∑ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è 2, –∑–∞–¥–∞—á–∞ 3. –û–¥–Ω–∞–∫–æ –Ω–∞ —ç—Ç–æ—Ç —Ä–∞–∑ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–µ–¥–∏–∫–∞—Ç EXISTS –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤, –≤–∫–ª—é—á–∞—é—â–∏—Ö —Ç–æ–ª—å–∫–æ —Ç–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤, —É –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –∑–∞–∫–∞–∑–æ–≤. –¢–∞–∫–∂–µ –≤–∞–º –Ω–µ –Ω—É–∂–Ω–æ —è–≤–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å, —á—Ç–æ —Å—Ç–æ–ª–±–µ—Ü custid –≤ —Ç–∞–±–ª–∏—Ü–µ Sales.Orders –Ω–µ —Ä–∞–≤–µ–Ω NULL.
–í—ã–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–π –≤–∞–º–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–º–∏ –≤ —Ñ–∞–π–ª–µ D:\Labfiles\Lab10\Solution\73 - Lab Exercise 3 - Task 2 Result.txt.
–ü–æ—á–µ–º—É –≤–∞–º –Ω–µ –ø—Ä–∏—à–ª–æ—Å—å –ø—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–∞–ª–∏—á–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è NULL?

‚úîÔ∏è –ó–∞–¥–∞—á–∞ 3: –ù–∞–ø–∏—Å–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ SELECT –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤, –∫—É–ø–∏–≤—à–∏—Ö –¥–æ—Ä–æ–≥–∏–µ –ø—Ä–æ–¥—É–∫—Ç—ã

–ù–∞–ø–∏—à–∏—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä SELECT –¥–ª—è –≤—ã–±–æ—Ä–∫–∏ —Å—Ç–æ–ª–±—Ü–æ–≤ custid –∏ contactname –∏–∑ —Ç–∞–±–ª–∏—Ü—ã Sales.Customers. –û—Ç—Ñ–∏–ª—å—Ç—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –≤–∫–ª—é—á–∏–≤ —Ç–æ–ª—å–∫–æ —Ç–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–∑–º–µ—Å—Ç–∏–ª–∏ –∑–∞–∫–∞–∑ –ø–æ—Å–ª–µ –∏–ª–∏ –Ω–∞—á–∏–Ω–∞—è —Å 1 –∞–ø—Ä–µ–ª—è 2008 –≥–æ–¥–∞ –∏ –∫—É–ø–∏–ª–∏ –ø—Ä–æ–¥—É–∫—Ç —Å—Ç–æ–∏–º–æ—Å—Ç—å—é –≤—ã—à–µ $100.
–í—ã–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–π –≤–∞–º–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–º–∏ –≤ —Ñ–∞–π–ª–µ D:\Labfiles\Lab10\Solution\74 - Lab Exercise 3 - Task 3 Result.txt.

‚úîÔ∏è –ó–∞–¥–∞—á–∞ 4: –ù–∞–ø–∏—Å–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ SELECT –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ–±—â–µ–π —Å—É–º–º—ã –ø—Ä–æ–¥–∞–∂ –∏ –Ω–∞—Ä–∞—Å—Ç–∞—é—â–µ–π –∏—Ç–æ–≥–æ–≤–æ–π —Å—É–º–º—ã –ø—Ä–æ–¥–∞–∂ –ø–æ –∫–∞–∂–¥–æ–º—É –≥–æ–¥—É –∑–∞–∫–∞–∑–æ–≤

–ù–∞—Ä–∞—Å—Ç–∞—é—â–∏–µ –∏—Ç–æ–≥–∏ –Ω–∞–∫–∞–ø–ª–∏–≤–∞—é—Ç –∑–Ω–∞—á–µ–Ω–∏—è —Å —Ç–µ—á–µ–Ω–∏–µ–º –≤—Ä–µ–º–µ–Ω–∏. –ù–∞–ø–∏—à–∏—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä SELECT –¥–ª—è –≤—ã–≤–æ–¥–∞ —Å–ª–µ–¥—É—é—â–µ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ –∫–∞–∂–¥–æ–º—É –≥–æ–¥—É:
–ì–æ–¥ –∑–∞–∫–∞–∑–∞.
–û–±—â–∞—è —Å—É–º–º–∞ –ø—Ä–æ–¥–∞–∂.
–ù–∞—Ä–∞—Å—Ç–∞—é—â–∞—è –æ–±—â–∞—è —Å—É–º–º–∞ –ø—Ä–æ–¥–∞–∂ –ø–æ –≥–æ–¥–∞–º. –¢–æ –µ—Å—Ç—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≥–æ–¥–∞ –≤–µ—Ä–Ω–∏—Ç–µ —Å—É–º–º—É –ø—Ä–æ–¥–∞–∂ –≤–ø–ª–æ—Ç—å –¥–æ —ç—Ç–æ–≥–æ –≥–æ–¥–∞. –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è —Å–∞–º–æ–≥–æ —Ä–∞–Ω–Ω–µ–≥–æ –≥–æ–¥–∞ (2006 –≥.) –≤–æ–∑–≤—Ä–∞—Ç–∏—Ç–µ –æ–±—â—É—é —Å—É–º–º—É –ø—Ä–æ–¥–∞–∂; –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –≥–æ–¥–∞ (2007 –≥.) –≤–æ–∑–≤—Ä–∞—Ç–∏—Ç–µ —Å—É–º–º—É –æ–±—â–µ–π —Å—É–º–º—ã –ø—Ä–æ–¥–∞–∂ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –≥–æ–¥–∞ –ø–ª—é—Å 2007 –≥–æ–¥.
–û–ø–µ—Ä–∞—Ç–æ—Ä SELECT –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç—Ä–∏ –≤—ã—á–∏—Å–ª—è–µ–º—ã–µ —Å—Ç–æ–ª–±—Ü–∞:
orderyear ‚Äî –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –≥–æ–¥ –∑–∞–∫–∞–∑–∞. –≠—Ç–æ—Ç —Å—Ç–æ–ª–±–µ—Ü –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ —Å—Ç–æ–ª–±—Ü–µ orderyear –∏–∑ —Ç–∞–±–ª–∏—Ü—ã Sales.Orders.
totalsales ‚Äî –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –æ–±—â—É—é —Å—É–º–º—É –ø—Ä–æ–¥–∞–∂ –∑–∞ –∫–∞–∂–¥—ã–π –≥–æ–¥. –≠—Ç–æ—Ç —Å—Ç–æ–ª–±–µ—Ü –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ —Å—Ç–æ–ª–±—Ü–∞—Ö qty –∏ unitprice –∏–∑ —Ç–∞–±–ª–∏—Ü—ã Sales.OrderDetails.
runsales ‚Äî –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –Ω–∞—Ä–∞—Å—Ç–∞—é—â—É—é —Å—É–º–º—É –ø—Ä–æ–¥–∞–∂. –≠—Ç–æ—Ç —Å—Ç–æ–ª–±–µ—Ü –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥–∑–∞–ø—Ä–æ—Å.
–í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–¥ T-SQL –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–º–∏ –≤ —Ñ–∞–π–ª–µ D:\Labfiles\Lab10\Solution\75 - Lab Exercise 3 - Task 4 Result.txt.

‚úîÔ∏è –ó–∞–¥–∞—á–∞ 5: –û—á–∏—Å—Ç–∫–∞ —Ç–∞–±–ª–∏—Ü—ã Sales.Customers

–£–¥–∞–ª–∏—Ç–µ —Å—Ç—Ä–æ–∫—É, –¥–æ–±–∞–≤–ª–µ–Ω–Ω—É—é –≤ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–∏ 2, –∏—Å–ø–æ–ª—å–∑—É—è —Å–ª–µ–¥—É—é—â–∏–π SQL-–∑–∞–ø—Ä–æ—Å:

DELETE Sales.Orders
WHERE custid IS NULL;
–í—ã–ø–æ–ª–Ω–∏—Ç–µ —ç—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å —Ç–æ—á–Ω–æ —Ç–∞–∫ –∂–µ, –∫–∞–∫ –Ω–∞–ø–∏—Å–∞–Ω–æ, –≤–Ω—É—Ç—Ä–∏ –æ–∫–Ω–∞ –∑–∞–ø—Ä–æ—Å–∞.
```


–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ –º–Ω–æ–∂–µ—Å—Ç–≤–∞
```
–°—Ü–µ–Ω–∞—Ä–∏–π–ë—É–¥—É—á–∏ –±–∏–∑–Ω–µ—Å-–∞–Ω–∞–ª–∏—Ç–∏–∫–æ–º –∫–æ–º–ø–∞–Ω–∏–∏ Adventure Works, –≤—ã –±—É–¥–µ—Ç–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –æ—Ç—á—ë—Ç—ã, –∏—Å–ø–æ–ª—å–∑—É—è –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, —Ö—Ä–∞–Ω—è—â–∏–µ—Å—è –≤ SQL Server. –í–∞–º –±—ã–ª–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω—ã —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –±–∏–∑–Ω–µ—Å–∞ –∫ –¥–∞–Ω–Ω—ã–º, –∏ –≤—ã –Ω–∞–ø–∏—à–µ—Ç–µ –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ T-SQL –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —É–∫–∞–∑–∞–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏–∑ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö. –ò–∑-–∑–∞ —Å–ª–æ–∂–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –±–∏–∑–Ω–µ—Å–∞ –≤–∞–º –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –≥–æ—Ç–æ–≤–∏—Ç—å –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤, –∏—Å–ø–æ–ª—å–∑—É—è –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã –º–Ω–æ–∂–µ—Å—Ç–≤.

–¶–µ–ª–∏–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —ç—Ç–æ–π –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏ –≤—ã —Å–º–æ–∂–µ—Ç–µ:

–ü–∏—Å–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã UNION –∏ UNION ALL.
–ü–∏—Å–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã CROSS APPLY –∏ OUTER APPLY.
–ü–∏—Å–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã EXCEPT –∏ INTERSECT.
–ü—Ä–∏–º–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è: 60 –º–∏–Ω—É—Ç

–í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞: 20761C-MIA-SQL

–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: ADVENTUREWORKS\Student

–ü–∞—Ä–æ–ª—å: Pa55w.rd
```
–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ 1: –ù–∞–ø–∏—Å–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏—Ö –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è UNION –∏ UNION ALL
```
–°—Ü–µ–Ω–∞—Ä–∏–π–û—Ç–¥–µ–ª –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞ –Ω—É–∂–¥–∞–µ—Ç—Å—è –≤ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∫–∞—Å–∞—Ç–µ–ª—å–Ω–æ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∏ –∫–ª–∏–µ–Ω—Ç–æ–≤. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å –æ—Ç—á—ë—Ç, –æ–±—ä–µ–¥–∏–Ω—è—é—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –æ–¥–Ω—É —Å–≤–æ–¥–∫—É. –î–ª—è —ç—Ç–æ–≥–æ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä UNION –¥–ª—è –Ω–∞–ø–∏—Å–∞–Ω–∏—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ SELECT –∏ –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–ª–∏—è–Ω–∏—è –∏—Ö –≤ –µ–¥–∏–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

–û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏ —ç—Ç–æ–≥–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –≤–∫–ª—é—á–∞—é—Ç —Å–ª–µ–¥—É—é—â–µ–µ:

–ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—É—é —Å—Ä–µ–¥—É.
–ù–∞–ø–∏—à–∏—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä SELECT –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤.
–ù–∞–ø–∏—à–∏—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä SELECT –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤ —Å –æ–±—â–µ–π —Å—É–º–º–æ–π –ø—Ä–æ–¥–∞–∂ –±–æ–ª–µ–µ $50,000.
–û–±—ä–µ–¥–∏–Ω–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∑–∞–¥–∞–Ω–∏–π 1 –∏ 2.
–ù–∞–ø–∏—à–∏—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä SELECT –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–ø-10 –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ —Å—É–º–º–µ –ø—Ä–æ–¥–∞–∂ –∑–∞ —è–Ω–≤–∞—Ä—å –∏ —Ñ–µ–≤—Ä–∞–ª—å 2008 –≥–æ–¥–∞.
```
## –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è (set operators)

### ‚òëÔ∏è –ó–∞–¥–∞–Ω–∏–µ 1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Å—Ä–µ–¥—ã
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ–±–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã 20761C-MIA-DC –∏ 20761C-MIA-SQL –∑–∞–ø—É—â–µ–Ω—ã. –ó–∞—Ç–µ–º –∑–∞–π–¥–∏—Ç–µ –Ω–∞ –º–∞—à–∏–Ω—É 20761C-MIA-SQL –ø–æ–¥ —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å—å—é ADVENTUREWORKS\Student —Å –ø–∞—Ä–æ–ª–µ–º Pa55w.rd.
   
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ñ–∞–π–ª Setup.cmd –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ D:\Labfiles\Lab12\Starter –æ—Ç –∏–º–µ–Ω–∏ –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.

---

### ‚òëÔ∏è –ó–∞–¥–∞–Ω–∏–µ 2: –ù–∞–ø–∏—Å–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ SELECT –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤
1. –í —Å—Ä–µ–¥–µ SQL Server Management Studio –æ—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–æ–µ–∫—Ç-—Ñ–∞–π–ª D:\Labfiles\Lab12\Starter\Project\Project.ssmssln –∏ —Å–∫—Ä–∏–ø—Ç T-SQL 51-Lab Exercise 1.sql. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö TSQL.

2. –ù–∞–ø–∏—à–∏—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä SELECT –¥–ª—è –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ `productid` –∏ `productname` –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `Production.Products`. –í–∫–ª—é—á–∏—Ç–µ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–æ–ª—å–∫–æ —Ç–æ–≤–∞—Ä—ã, –æ—Ç–Ω–æ—Å—è—â–∏–µ—Å—è –∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ 4 (`categoryid=4`).

```sql
SELECT productid, productname
FROM Production.Products
WHERE categoryid = 4;
```

3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å —Ç–µ–º–∏, —á—Ç–æ —É–∫–∞–∑–∞–Ω—ã –≤ —Ñ–∞–π–ª–µ `D:\Labfiles\Lab12\Solution\52 - Lab Exercise 1 - Task 1 Result.txt`. –ó–∞–ø–æ–º–Ω–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ.

---

### ‚òëÔ∏è –ó–∞–¥–∞–Ω–∏–µ 3: –ù–∞–ø–∏—Å–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ SELECT –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤ —Å –æ–±—ä–µ–º–æ–º –ø—Ä–æ–¥–∞–∂ –±–æ–ª–µ–µ $50,000
1. –ù–∞–ø–∏—à–∏—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä SELECT –¥–ª—è –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ `productid` –∏ `productname` –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `Production.Products`. –í–∫–ª—é—á–∏—Ç–µ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–æ–ª—å–∫–æ —Ç–æ–≤–∞—Ä—ã, –æ–±—â–∏–π –æ–±—ä–µ–º –ø—Ä–æ–¥–∞–∂ –∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–µ–≤—ã—à–∞–µ—Ç $50,000. –û–±—ä–µ–º –ø—Ä–æ–¥–∞–∂ —Ä–∞—Å—Å—á–∏—Ç–∞–π—Ç–µ, –æ–±—Ä–∞—Ç–∏–≤—à–∏—Å—å –∫ —Ç–∞–±–ª–∏—Ü–µ `Sales.OrderDetails` –∏ —Å—É–º–º–∏—Ä–æ–≤–∞–≤ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∏ —Ü–µ–Ω—ã –µ–¥–∏–Ω–∏—Ü—ã –ø—Ä–æ–¥—É–∫—Ç–∞ (`qty * unitprice`) –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞.

```sql
SELECT p.productid, p.productname
FROM Production.Products AS p
JOIN Sales.OrderDetails AS od ON p.productid = od.productid
GROUP BY p.productid, p.productname
HAVING SUM(od.qty * od.unitprice) > 50000;
```

2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å —Ç–µ–º–∏, —á—Ç–æ —É–∫–∞–∑–∞–Ω—ã –≤ —Ñ–∞–π–ª–µ `D:\Labfiles\Lab12\Solution\53 - Lab Exercise 1 - Task 2 Result.txt`. –ó–∞–ø–æ–º–Ω–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ.

---

### ‚òëÔ∏è –ó–∞–¥–∞–Ω–∏–µ 4: –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏–∑ –∑–∞–¥–∞–Ω–∏–π 1 –∏ 2
1. –ù–∞–ø–∏—à–∏—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä SELECT, –∫–æ—Ç–æ—Ä—ã–π –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∑–∞–¥–∞–Ω–∏–π 1 –∏ 2 —Å –ø–æ–º–æ—â—å—é –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ UNION:

```sql
-- –†–µ–∑—É–ª—å—Ç–∞—Ç –∏–∑ –∑–∞–¥–∞–Ω–∏—è 1
SELECT productid, productname
FROM Production.Products
WHERE categoryid = 4

UNION

-- –†–µ–∑—É–ª—å—Ç–∞—Ç –∏–∑ –∑–∞–¥–∞–Ω–∏—è 2
SELECT p.productid, p.productname
FROM Production.Products AS p
JOIN Sales.OrderDetails AS od ON p.productid = od.productid
GROUP BY p.productid, p.productname
HAVING SUM(od.qty * od.unitprice) > 50000;
```

2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å —Ç–µ–º–∏, —á—Ç–æ —É–∫–∞–∑–∞–Ω—ã –≤ —Ñ–∞–π–ª–µ `D:\Labfiles\Lab12\Solution\54 - Lab Exercise 1 - Task 3_1 Result.txt`.

3. –ü–æ—Å—á–∏—Ç–∞–π—Ç–µ –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –≤ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö. –ï—Å–ª–∏ —Å—Ä–∞–≤–Ω–∏—Ç—å —ç—Ç–æ —á–∏—Å–ª–æ —Å —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç—å—é —á–∏—Å–µ–ª —Å—Ç—Ä–æ–∫ –∏–∑ –∑–∞–¥–∞–Ω–∏–π 1 –∏ 2, –∑–∞–º–µ—Ç–Ω–∞ –ª–∏ –∫–∞–∫–∞—è-—Ç–æ —Ä–∞–∑–Ω–∏—Ü–∞?

4. –ü—Ä–æ–¥—É–±–ª–∏—Ä—É–π—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä SELECT –∏ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–π—Ç–µ –µ–≥–æ, –∑–∞–º–µ–Ω–∏–≤ –æ–ø–µ—Ä–∞—Ç–æ—Ä UNION –Ω–∞ UNION ALL:

```sql
-- –†–µ–∑—É–ª—å—Ç–∞—Ç –∏–∑ –∑–∞–¥–∞–Ω–∏—è 1
SELECT productid, productname
FROM Production.Products
WHERE categoryid = 4

UNION ALL

-- –†–µ–∑—É–ª—å—Ç–∞—Ç –∏–∑ –∑–∞–¥–∞–Ω–∏—è 2
SELECT p.productid, p.productname
FROM Production.Products AS p
JOIN Sales.OrderDetails AS od ON p.productid = od.productid
GROUP BY p.productid, p.productname
HAVING SUM(od.qty * od.unitprice) > 50000;
```

5. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –Ω–æ–≤—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å —Ç–µ–º–∏, —á—Ç–æ —É–∫–∞–∑–∞–Ω—ã –≤ —Ñ–∞–π–ª–µ `D:\Labfiles\Lab12\Solution\55 - Lab Exercise 1 - Task 3_2 Result.txt`.

6. –ü–æ—Å—á–∏—Ç–∞–π—Ç–µ –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –≤ –Ω–æ–≤–æ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ. –í —á—ë–º –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è —Ä–∞–∑–ª–∏—á–∏–µ –º–µ–∂–¥—É –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º–∏ UNION –∏ UNION ALL?

---

### ‚òëÔ∏è –ó–∞–¥–∞–Ω–∏–µ 5: –í—ã–±–æ—Ä–∫–∞ —Ç–æ–ø-10 –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ –æ–±—ä—ë–º–∞–º –ø—Ä–æ–¥–∞–∂ –∑–∞ —è–Ω–≤–∞—Ä—å –∏ —Ñ–µ–≤—Ä–∞–ª—å 2008 –≥–æ–¥–∞
1. –ù–∞–ø–∏—à–∏—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä SELECT –¥–ª—è –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ `custid` –∏ `contactname` –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `Sales.Customers`, –≤—ã–±—Ä–∞–≤ —Ç–æ–ø-10 –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ –æ–±—ä–µ–º—É –ø—Ä–æ–¥–∞–∂ –æ—Ç–¥–µ–ª—å–Ω–æ –∑–∞ —è–Ω–≤–∞—Ä—å –∏ —Ñ–µ–≤—Ä–∞–ª—å 2008 –≥–æ–¥–∞. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–≤–µ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ SELECT, –∫–∞–∂–¥–∞—è –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–∏—Å–æ–µ–¥–∏–Ω—è–µ—Ç—Å—è –∫ —Ç–∞–±–ª–∏—Ü–µ `Sales.OrderValues`, –∏ –æ–±—ä–µ–¥–∏–Ω–∏—Ç–µ –∏—Ö —Å –ø–æ–º–æ—â—å—é –ø–æ–¥—Ö–æ–¥—è—â–µ–≥–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–∞:

```sql
-- –¢–æ–ø-10 –∫–ª–∏–µ–Ω—Ç–æ–≤ –∑–∞ —è–Ω–≤–∞—Ä—å 2008
SELECT TOP 10 c.custid, c.contactname
FROM Sales.Customers AS c
JOIN Sales.OrderValues AS ov ON c.custid = ov.custid
WHERE ov.ordermonth = '2008-01'
ORDER BY ov.salesamount DESC

UNION ALL

-- –¢–æ–ø-10 –∫–ª–∏–µ–Ω—Ç–æ–≤ –∑–∞ —Ñ–µ–≤—Ä–∞–ª—å 2008
SELECT TOP 10 c.custid, c.contactname
FROM Sales.Customers AS c
JOIN Sales.OrderValues AS ov ON c.custid = ov.custid
WHERE ov.ordermonth = '2008-02'
ORDER BY ov.salesamount DESC;
```

2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å —Ç–µ–º–∏, —á—Ç–æ —É–∫–∞–∑–∞–Ω—ã –≤ —Ñ–∞–π–ª–µ `D:\Labfiles\Lab12\Solution\56 - Lab Exercise 1 - Task 4 Result.txt`.

## –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ 2: –ù–∞–ø–∏—Å–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ CROSS APPLY –∏ OUTER APPLY

### üìå –°—Ü–µ–Ω–∞—Ä–∏–π
–û—Ç–¥–µ–ª –ø—Ä–æ–¥–∞–∂ —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–æ–≤–µ—Å—Ç–∏ —É–≥–ª—É–±–ª–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è. –ù—É–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç—Ä–∏ –Ω–∞–∏–±–æ–ª–µ–µ –ø—Ä–æ–¥–∞–≤–∞–µ–º—ã—Ö —Ç–æ–≤–∞—Ä–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è, –∏—Å—Ö–æ–¥—è –∏–∑ –æ–±—ä–µ–º–∞ –≤—ã—Ä—É—á–∫–∏. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä APPLY –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —ç—Ç–æ–π —Ü–µ–ª–∏.

### –û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏:
1. –ù–∞–ø–∏—Å–∞—Ç—å –æ–ø–µ—Ä–∞—Ç–æ—Ä SELECT, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π –æ–ø–µ—Ä–∞—Ç–æ—Ä CROSS APPLY, –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –¥–≤—É—Ö –∑–∞–∫–∞–∑–æ–≤ –ø–æ –∫–∞–∂–¥–æ–º—É —Ç–æ–≤–∞—Ä—É.
2. –ù–∞–ø–∏—Å–∞—Ç—å –æ–ø–µ—Ä–∞—Ç–æ—Ä SELECT, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π –æ–ø–µ—Ä–∞—Ç–æ—Ä CROSS APPLY, –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç—Ä–µ—Ö –ª—É—á—à–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –æ–±—ä–µ–º—É –≤—ã—Ä—É—á–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞.
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–ø–µ—Ä–∞—Ç–æ—Ä OUTER APPLY.
4. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ OUTER APPLY.
5. –£–¥–∞–ª–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—É—é —Ç–∞–±–ª–∏—á–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é (TVF), —Å–æ–∑–¥–∞–Ω–Ω—É—é –¥–ª—è —ç—Ç–æ–≥–æ –∑–∞–Ω—è—Ç–∏—è.

---

### ‚úÖ –ó–∞–¥–∞—á–∞ 1: –ù–∞–ø–∏—Å–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ SELECT —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ CROSS APPLY –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –¥–≤—É—Ö –∑–∞–∫–∞–∑–æ–≤ –ø–æ –∫–∞–∂–¥–æ–º—É —Ç–æ–≤–∞—Ä—É

#### –®–∞–≥–∏:
1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å–∫—Ä–∏–ø—Ç T-SQL 61-Lab Exercise 2.sql. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö TSQL.

2. –ù–∞–ø–∏—à–∏—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä SELECT –¥–ª—è –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ `productid` –∏ `productname` –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `Production.Products`. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ –ø–æ–ª—É—á–∏—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –¥–≤–µ –∑–∞–ø–∏—Å–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `Sales.OrderDetails`, –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ –Ω–æ–º–µ—Ä—É –∑–∞–∫–∞–∑–∞ (`orderid`).

```sql
SELECT pp.productid, pp.productname, od.*
FROM Production.Products AS pp
CROSS APPLY (
    SELECT TOP 2 *
    FROM Sales.OrderDetails AS od
    WHERE od.productid = pp.productid
    ORDER BY od.orderid DESC
) AS od
ORDER BY pp.productid;
```

3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å –æ–∂–∏–¥–∞–µ–º—ã–º–∏, –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–º–∏ –≤ —Ñ–∞–π–ª–µ `D:\Labfiles\Lab12\Solution\62 - Lab Exercise 2 - Task 1 Result.txt`.

---

### ‚úÖ –ó–∞–¥–∞—á–∞ 2: –ù–∞–ø–∏—Å–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ SELECT —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ CROSS APPLY –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç—Ä—ë—Ö –ª—É—á—à–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –æ–±—ä–µ–º—É –≤—ã—Ä—É—á–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞

#### –®–∞–≥–∏:
1. –°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–π—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω—É—é —Ç–∞–±–ª–∏—á–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é (TVF) `fnGetTop3ProductsForCustomer`, –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç—Ä–∏ –ª—É—á—à–∏—Ö —Ç–æ–≤–∞—Ä–∞ –ø–æ –≤—ã—Ä—É—á–∫–µ –¥–ª—è –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞:

```sql
DROP FUNCTION IF EXISTS dbo.fnGetTop3ProductsForCustomer;
GO
CREATE FUNCTION dbo.fnGetTop3ProductsForCustomer
(@custid AS INT) RETURNS TABLE
AS
RETURN
SELECT TOP(3)
    d.productid,
    p.productname,
    SUM(d.qty * d.unitprice) AS totalsalesamount
FROM Sales.Orders AS o
INNER JOIN Sales.OrderDetails AS d ON d.orderid = o.orderid
INNER JOIN Production.Products AS p ON p.productid = d.productid
WHERE o.custid = @custid
GROUP BY d.productid, p.productname
ORDER BY totalsalesamount DESC;
```

2. –¢–µ–ø–µ—Ä—å –Ω–∞–ø–∏—à–∏—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä SELECT –¥–ª—è –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ `custid` –∏ `contactname` –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `Sales.Customers`. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä CROSS APPLY –≤–º–µ—Å—Ç–µ —Å —Ñ—É–Ω–∫—Ü–∏–µ–π `dbo.fnGetTop3ProductsForCustomer`, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Å—Ç–æ–ª–±—Ü—ã `productid`, `productname` –∏ `totalsalesamount` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞.

```sql
SELECT sc.custid, sc.contactname, tpc.productid, tpc.productname, tpc.totalsalesamount
FROM Sales.Customers AS sc
CROSS APPLY dbo.fnGetTop3ProductsForCustomer(sc.custid) AS tpc;
```

3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å –æ–∂–∏–¥–∞–µ–º–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–π –≤ —Ñ–∞–π–ª–µ `D:\Labfiles\Lab12\Solution\63 - Lab Exercise 2 - Task 2 Result.txt`. –ó–∞–ø–æ–º–Ω–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –≤ –≤—ã–≤–æ–¥–µ.

---

### ‚úÖ –ó–∞–¥–∞—á–∞ 3: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ OUTER APPLY

#### –®–∞–≥–∏:
1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä SELECT –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –∑–∞–¥–∞—á–∏ –∏ –∑–∞–º–µ–Ω–∏—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä CROSS APPLY –Ω–∞ OUTER APPLY.

```sql
SELECT sc.custid, sc.contactname, tpc.productid, tpc.productname, tpc.totalsalesamount
FROM Sales.Customers AS sc
OUTER APPLY dbo.fnGetTop3ProductsForCustomer(sc.custid) AS tpc;
```

2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –Ω–æ–≤—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å –∂–µ–ª–∞–µ–º—ã–º–∏, –ø—Ä–∏–≤–µ–¥—ë–Ω–Ω—ã–º–∏ –≤ —Ñ–∞–π–ª–µ `D:\Labfiles\Lab12\Solution\64 - Lab Exercise 2 - Task 3 Result.txt`. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ —Ç–µ–ø–µ—Ä—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –±–æ–ª—å—à–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫, —á–µ–º —Ä–∞–Ω—å—à–µ.

---

### ‚úÖ –ó–∞–¥–∞—á–∞ 4: –ê–Ω–∞–ª–∏–∑ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ OUTER APPLY

#### –®–∞–≥–∏:
1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä SELECT –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –∑–∞–¥–∞—á–∏ –∏ –¥–æ–±–∞–≤—å—Ç–µ —É—Å–ª–æ–≤–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞ –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ WHERE, —á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å —Ç–æ–ª—å–∫–æ –∫–ª–∏–µ–Ω—Ç–æ–≤, —É –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤. –í–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –Ω–∞–ª–∏—á–∏—è –ø—É—Å—Ç–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è (`NULL`), –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–≥–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–π —Ç–∞–±–ª–∏—á–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π.

```sql
SELECT sc.custid, sc.contactname
FROM Sales.Customers AS sc
OUTER APPLY dbo.fnGetTop3ProductsForCustomer(sc.custid) AS tpc
WHERE tpc.productid IS NULL;
```

2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –Ω–æ–≤—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–º–∏ –≤ —Ñ–∞–π–ª–µ `D:\Labfiles\Lab12\Solution\65 - Lab Exercise 2 - Task 4 Result.txt`.

3. –í —á—ë–º —Å–æ—Å—Ç–æ–∏—Ç –æ—Å–Ω–æ–≤–Ω–æ–µ –æ—Ç–ª–∏—á–∏–µ –º–µ–∂–¥—É –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º–∏ CROSS APPLY –∏ OUTER APPLY?

---

### ‚úÖ –ó–∞–¥–∞—á–∞ 5: –£–¥–∞–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–π —Ç–∞–±–ª–∏—á–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ (TVF), —Å–æ–∑–¥–∞–Ω–Ω–æ–π –¥–ª—è —ç—Ç–æ–≥–æ —É—Ä–æ–∫–∞

#### –®–∞–≥–∏:
1. –£–¥–∞–ª–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—É—é —Ä–∞–Ω–µ–µ –≤—Ä–µ–º–µ–Ω–Ω—É—é —Ç–∞–±–ª–∏—á–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é —Å –ø–æ–º–æ—â—å—é —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞:

```sql
DROP FUNCTION IF EXISTS dbo.fnGetTop3ProductsForCustomer;
```

2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —ç—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç —Ç–æ—á–Ω–æ —Ç–∞–∫, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ, –≤ –æ–∫–Ω–µ –∑–∞–ø—Ä–æ—Å–∞.

## –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ 3: –ù–∞–ø–∏—Å–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ EXCEPT –∏ INTERSECT

### üìå –°—Ü–µ–Ω–∞—Ä–∏–π
–û—Ç–¥–µ–ª –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—ë–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –ø–µ—Ä–≤–æ–≥–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è, –æ–¥–Ω–∞–∫–æ —Ç–µ–ø–µ—Ä—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ —Ö–æ—Ç—è—Ç —É–≤–∏–¥–µ—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –∏–∑ –æ–¥–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤, –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –≤ –¥—Ä—É–≥–æ–º –Ω–∞–±–æ—Ä–µ. –î–ª—è —ç—Ç–æ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ—Å—Ç–∞–≤–∏—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã, –∏—Å–ø–æ–ª—å–∑—É—è –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã EXCEPT –∏ INTERSECT.

### –û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏:
1. –ù–∞–ø–∏—Å–∞—Ç—å –æ–ø–µ—Ä–∞—Ç–æ—Ä SELECT –¥–ª—è –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏—è –≤—Å–µ—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π, –ø—Ä–∏–æ–±—Ä–µ—Ç—à–∏—Ö –±–æ–ª–µ–µ 20 —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤.
2. –ù–∞–ø–∏—Å–∞—Ç—å –æ–ø–µ—Ä–∞—Ç–æ—Ä SELECT –¥–ª—è –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏—è –≤—Å–µ—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –∏–∑ –°–®–ê, –∏—Å–∫–ª—é—á–∞—è —Ç–µ—Ö, –∫—Ç–æ –ø—Ä–∏–æ–±—Ä—ë–ª –±–æ–ª–µ–µ 20 —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤.
3. –ù–∞–ø–∏—Å–∞—Ç—å –æ–ø–µ—Ä–∞—Ç–æ—Ä SELECT –¥–ª—è –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏—è –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π, –ø–æ—Ç—Ä–∞—Ç–∏–≤—à–∏—Ö –±–æ–ª–µ–µ $10,000.
4. –°–æ—Å—Ç–∞–≤–∏—Ç—å –æ–ø–µ—Ä–∞—Ç–æ—Ä SELECT, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã EXCEPT –∏ INTERSECT.
5. –ò–∑–º–µ–Ω–∏—Ç—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤.

---

### ‚úÖ –ó–∞–¥–∞—á–∞ 1: –í–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π, –ø—Ä–∏–æ–±—Ä–µ—Ç—à–∏—Ö –±–æ–ª–µ–µ 20 —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤

#### –®–∞–≥–∏:
1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å–∫—Ä–∏–ø—Ç T-SQL 71-Lab Exercise 3.sql. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö TSQL.

2. –ù–∞–ø–∏—à–∏—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä SELECT –¥–ª—è –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞ `custid` –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `Sales.Orders`. –í–∫–ª—é—á–∏—Ç–µ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–æ–ª—å–∫–æ —Ç–µ—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–æ–±—Ä–µ–ª–∏ –±–æ–ª–µ–µ 20 —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ (–æ—Ü–µ–Ω–∏–≤–∞—è –ø–æ —Å—Ç–æ–ª–±—Ü—É `productid` –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `Sales.OrderDetails`).

```sql
SELECT custid
FROM Sales.Orders AS o
WHERE custid IN (
    SELECT custid
    FROM Sales.OrderDetails
    GROUP BY custid
    HAVING COUNT(DISTINCT productid) > 20
);
```

3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–º–∏, –ø—Ä–∏–≤–µ–¥—ë–Ω–Ω—ã–º–∏ –≤ —Ñ–∞–π–ª–µ `D:\Labfiles\Lab12\Solution\72 - Lab Exercise 3 - Task 1 Result.txt`.

---

### ‚úÖ –ó–∞–¥–∞—á–∞ 2: –í–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –∏–∑ –°–®–ê, –∫—Ä–æ–º–µ —Ç–µ—Ö, –∫—Ç–æ –ø—Ä–∏–æ–±—Ä–µ–ª –±–æ–ª–µ–µ 20 —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤

#### –®–∞–≥–∏:
1. –ù–∞–ø–∏—à–∏—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä SELECT –¥–ª—è –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞ `custid` –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `Sales.Orders`. –í–∫–ª—é—á–∏—Ç–µ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–æ–ª—å–∫–æ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –∏–∑ –°–®–ê, –∏—Å–∫–ª—é—á–∏–≤ —Ç–µ—Ö, –∫—Ç–æ –ø–æ—è–≤–∏–ª—Å—è –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ (–∑–∞–¥–∞—á–∞ 1). –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä EXCEPT —Å–æ–≤–º–µ—Å—Ç–Ω–æ —Å –∑–∞–ø—Ä–æ—Å–æ–º –∏–∑ –ø–µ—Ä–≤–æ–π –∑–∞–¥–∞—á–∏.

```sql
SELECT DISTINCT custid
FROM Sales.Customers
WHERE country = 'USA'
EXCEPT
SELECT custid
FROM Sales.Orders AS o
WHERE custid IN (
    SELECT custid
    FROM Sales.OrderDetails
    GROUP BY custid
    HAVING COUNT(DISTINCT productid) > 20
);
```

2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–º–∏, –ø—Ä–∏–≤–µ–¥—ë–Ω–Ω—ã–º–∏ –≤ —Ñ–∞–π–ª–µ `D:\Labfiles\Lab12\Solution\73 - Lab Exercise 3 - Task 2 Result.txt`.

---

### ‚úÖ –ó–∞–¥–∞—á–∞ 3: –í–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π, –ø–æ—Ç—Ä–∞—Ç–∏–≤—à–∏—Ö –±–æ–ª–µ–µ $10,000

#### –®–∞–≥–∏:
1. –ù–∞–ø–∏—à–∏—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä SELECT –¥–ª—è –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞ `custid` –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `Sales.Orders`. –í–∫–ª—é—á–∏—Ç–µ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–æ–ª—å–∫–æ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π, —á—å—è –æ–±—â–∞—è —Å—É–º–º–∞ –ø–æ–∫—É–ø–æ–∫ –ø—Ä–µ–≤—ã—Å–∏–ª–∞ $10,000. –†–∞—Å—Å—á–∏—Ç–∞–π—Ç–µ —Å—É–º–º—É –ø–æ–∫—É–ø–∫–∏, —É–º–Ω–æ–∂–∏–≤ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–∞ –Ω–∞ —Ü–µ–Ω—É (`qty * unitprice`) –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `Sales.OrderDetails`.

```sql
SELECT custid
FROM Sales.Orders AS o
WHERE custid IN (
    SELECT custid
    FROM Sales.OrderDetails
    GROUP BY custid
    HAVING SUM(qty * unitprice) > 10000
);
```

2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–º–∏, –ø—Ä–∏–≤–µ–¥—ë–Ω–Ω—ã–º–∏ –≤ —Ñ–∞–π–ª–µ `D:\Labfiles\Lab12\Solution\74 - Lab Exercise 3 - Task 3 Result.txt`.

---

### ‚úÖ –ó–∞–¥–∞—á–∞ 4: –ù–∞–ø–∏—Å–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ SELECT —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ EXCEPT –∏ INTERSECT

#### –®–∞–≥–∏:
1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä SELECT –∏–∑ –≤—Ç–æ—Ä–æ–π –∑–∞–¥–∞—á–∏ –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ –µ–≥–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º INTERSECT, –¥–æ–±–∞–≤–∏–≤ –ø–æ—Å–ª–µ –Ω–µ–≥–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä SELECT –∏–∑ —Ç—Ä–µ—Ç—å–µ–π –∑–∞–¥–∞—á–∏.

```sql
SELECT DISTINCT custid
FROM Sales.Customers
WHERE country = 'USA'
EXCEPT
SELECT custid
FROM Sales.Orders AS o
WHERE custid IN (
    SELECT custid
    FROM Sales.OrderDetails
    GROUP BY custid
    HAVING COUNT(DISTINCT productid) > 20
)
INTERSECT
SELECT custid
FROM Sales.Orders AS o
WHERE custid IN (
    SELECT custid
    FROM Sales.OrderDetails
    GROUP BY custid
    HAVING SUM(qty * unitprice) > 10000
);
```

2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–º–∏, –ø—Ä–∏–≤–µ–¥—ë–Ω–Ω—ã–º–∏ –≤ —Ñ–∞–π–ª–µ `D:\Labfiles\Lab12\Solution\75 - Lab Exercise 3 - Task 4 Result.txt`. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ.

3. –û–±—ä—è—Å–Ω–∏—Ç–µ, –∫–∞–∫–∏–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª–∏ –≤—Ö–æ–¥—è—Ç –≤ —Å–æ—Å—Ç–∞–≤ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞, –∏—Å—Ö–æ–¥—è –∏–∑ —Å–º—ã—Å–ª–∞ –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–π –∑–∞–¥–∞—á–∏.

---

### ‚úÖ –ó–∞–¥–∞—á–∞ 5: –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤

#### –®–∞–≥–∏:
1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä SELECT –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –∑–∞–¥–∞—á–∏ –∏ –∑–∞–∫–ª—é—á–∏—Ç–µ –ø–µ—Ä–≤—ã–µ –¥–≤–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ SELECT (–¥–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ INTERSECT) –≤ –∫—Ä—É–≥–ª—ã–µ —Å–∫–æ–±–∫–∏.

```sql
(SELECT DISTINCT custid
FROM Sales.Customers
WHERE country = 'USA'
EXCEPT
SELECT custid
FROM Sales.Orders AS o
WHERE custid IN (
    SELECT custid
    FROM Sales.OrderDetails
    GROUP BY custid
    HAVING COUNT(DISTINCT productid) > 20
))
INTERSECT
SELECT custid
FROM Sales.Orders AS o
WHERE custid IN (
    SELECT custid
    FROM Sales.OrderDetails
    GROUP BY custid
    HAVING SUM(qty * unitprice) > 10000
);
```

2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–º–∏, –ø—Ä–∏–≤–µ–¥—ë–Ω–Ω—ã–º–∏ –≤ —Ñ–∞–π–ª–µ `D:\Labfiles\Lab12\Solution\76 - Lab Exercise 3 - Task 5 Result.txt`. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ.

3. –û—Ç–ª–∏—á–∞—é—Ç—Å—è –ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö (–∑–∞–¥–∞—á–∏ 4)? –û–±—ä—è—Å–Ω–∏—Ç–µ –ø–æ—á–µ–º—É.

4. –ö–∞–∫–æ–π –ø–æ—Ä—è–¥–æ–∫ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ—Å—Ç–∏ –∏–º–µ—é—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã –º–Ω–æ–∂–µ—Å—Ç–≤–∞?

5. –ó–∞–∫—Ä–æ–π—Ç–µ —Å—Ä–µ–¥—É SQL Server Management Studio, –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—è –∏–∑–º–µ–Ω–µ–Ω–∏–π.
6. 
